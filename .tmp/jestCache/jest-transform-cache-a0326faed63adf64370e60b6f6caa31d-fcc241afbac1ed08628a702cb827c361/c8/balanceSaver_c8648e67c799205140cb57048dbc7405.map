{"file":"/home/optivamedia/Documents/Personal/bank-account-manager/server/contexts/backoffice/accounts/application/save/balanceSaver.ts","mappings":";;;;;AAIA,kFAA0D;AAE1D,MAAqB,YAAY;IAK7B,YAAY,UAA6B,EAAE,GAAa;QACpD,IAAI,CAAC,UAAU,GAAG,UAAU,CAAC;QAC7B,IAAI,CAAC,GAAG,GAAG,GAAG,CAAC;IACnB,CAAC;IAED,KAAK,CAAC,GAAG,CAAC,SAAoB,EAAE,MAAc;QAC1C,IAAI,OAAO,GAAG,MAAM,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;QAEnD,IAAI,CAAC,OAAO;YAAE,OAAO,GAAG,iBAAO,CAAC,aAAa,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC;;YAC5D,OAAO,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;QAEnC,MAAM,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;QACpC,MAAM,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,OAAO,CAAC,gBAAgB,EAAE,CAAC,CAAC;IACvD,CAAC;CACJ;AAnBD,+BAmBC","names":[],"sources":["/home/optivamedia/Documents/Personal/bank-account-manager/server/contexts/backoffice/accounts/application/save/balanceSaver.ts"],"sourcesContent":["import AccountRepository from '@backoffice/accounts/domain/accountRepository';\nimport { EventBus } from '@shared/domain/bus/event/eventBus';\nimport type AccountId from '@backoffice/accounts/domain/accountId';\nimport type Amount from '@backoffice/accounts/domain/amount';\nimport Account from '@backoffice/accounts/domain/account';\n\nexport default class BalanceSaver {\n    private repository: AccountRepository;\n\n    private bus: EventBus;\n\n    constructor(repository: AccountRepository, bus: EventBus) {\n        this.repository = repository;\n        this.bus = bus;\n    }\n\n    async run(accountId: AccountId, amount: Amount): Promise<void> {\n        let account = await this.repository.get(accountId);\n\n        if (!account) account = Account.createBalance(accountId, amount);\n        else account.updateBalance(amount);\n\n        await this.repository.save(account);\n        await this.bus.publish(account.pullDomainEvents());\n    }\n}\n"],"version":3}