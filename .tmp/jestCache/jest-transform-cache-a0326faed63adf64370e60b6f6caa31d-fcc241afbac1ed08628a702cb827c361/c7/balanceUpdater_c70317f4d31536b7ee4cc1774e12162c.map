{"file":"/home/optivamedia/Documents/Personal/bank-account-manager/server/contexts/backoffice/accounts/application/update/balanceUpdater.ts","mappings":";;;;;AAIA,kGAA0E;AAE1E,MAAqB,cAAc;IAK/B,YAAY,UAA6B,EAAE,GAAa;QACpD,IAAI,CAAC,UAAU,GAAG,UAAU,CAAC;QAC7B,IAAI,CAAC,GAAG,GAAG,GAAG,CAAC;IACnB,CAAC;IAED,KAAK,CAAC,GAAG,CAAC,SAAoB,EAAE,MAAc;QAC1C,MAAM,OAAO,GAAG,MAAM,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;QAErD,IAAI,CAAC,OAAO,EAAE;YACV,MAAM,IAAI,yBAAe,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;SAC9C;QAED,OAAO,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;QAE9B,MAAM,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;QACtC,MAAM,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,OAAO,CAAC,gBAAgB,EAAE,CAAC,CAAC;IACvD,CAAC;CACJ;AAtBD,iCAsBC","names":[],"sources":["/home/optivamedia/Documents/Personal/bank-account-manager/server/contexts/backoffice/accounts/application/update/balanceUpdater.ts"],"sourcesContent":["import AccountRepository from '@backoffice/accounts/domain/accountRepository';\nimport { EventBus } from '@shared/domain/bus/event/eventBus';\nimport type AccountId from '@backoffice/accounts/domain/accountId';\nimport type Amount from '@backoffice/accounts/domain/amount';\nimport AccountNotFound from '@backoffice/accounts/domain/accountNotFound';\n\nexport default class BalanceUpdater {\n    private repository: AccountRepository;\n\n    private bus: EventBus;\n\n    constructor(repository: AccountRepository, bus: EventBus) {\n        this.repository = repository;\n        this.bus = bus;\n    }\n\n    async run(accountId: AccountId, amount: Amount): Promise<void> {\n        const account = await this.repository.get(accountId);\n\n        if (!account) {\n            throw new AccountNotFound(accountId.value);\n        }\n\n        account.updateBalance(amount);\n\n        await this.repository.update(account);\n        await this.bus.publish(account.pullDomainEvents());\n    }\n}\n"],"version":3}